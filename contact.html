<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Contact et préinscription | Ludus Mentis</title>
  <meta name="description" content="Préinscrivez votre enfant au club Ludus Mentis. Sessions de gaming coopératif encadré à Walhain.">
  
  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Ludus Mentis" />
  <meta property="og:url" content="https://ludusmentis.be/contact.html" />
  <meta property="og:title" content="Contact et préinscription | Ludus Mentis" />
  <meta property="og:description" content="Rejoignez le club gaming éducatif. Places limitées, ouverture janvier 2026." />
   <script>
    (function(){
      var saved = localStorage.getItem('theme');
      var theme;
      if (saved) {
        theme = saved;
      } else {
        // Détecte TOUS les cas : système, per-device, forced dark mode
        try {
          theme = window.matchMedia('(prefers-color-scheme: dark)').matches ? 'ludus-dark' : 'light';
        } catch(e) {
          theme = 'light';
        }
      }
      document.documentElement.setAttribute('data-theme', theme);
      if (theme === 'ludus-dark') document.documentElement.classList.add('dark');
    })();
  </script>
  
  <script src="/assets/js/theme-manager.js"></script>
  <!-- Consent Mode v2 -->
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    
    gtag('consent', 'default', {
      'ad_storage': 'denied',
      'ad_user_data': 'denied',
      'ad_personalization': 'denied',
      'analytics_storage': 'denied',
      'functionality_storage': 'granted',
      'personalization_storage': 'granted',
      'security_storage': 'granted',
      'wait_for_update': 500
    });
  </script>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-WMCMP74V');</script>
  
  <!-- DaisyUI + Tailwind -->
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.10/dist/full.min.css" rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com"></script>
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            'ludus-teal': '#17a2b8',
            'ludus-orange': '#ff9800',
            'ludus-purple': '#6b46c1'
          }
        }
      }
    }
  </script>
  
  <link rel="icon" type="image/png" href="/assets/images/Ludus-Mentis-transparent.png">
  
  <style>
    .gradient-ludus {
      background: linear-gradient(135deg, #17a2b8 0%, #ff9800 100%);
    }
    
    /* Animation pour le message de succès */
    @keyframes slideInDown {
      from {
        transform: translateY(-100%);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }
    
    .success-message {
      animation: slideInDown 0.3s ease-out;
    }
  </style>
</head>
<body>
  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-WMCMP74V"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  
  <div id="header"></div>
  
  <main class="container mx-auto px-4 py-8 max-w-5xl">
    <!-- Message de succès (caché par défaut) -->
    <div id="successMessage" class="hidden fixed top-20 left-1/2 transform -translate-x-1/2 z-50 success-message">
      <div class="alert alert-success shadow-lg">
        <div>
          <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current flex-shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
          <span>Votre préinscription a bien été envoyée ! Nous vous recontacterons rapidement.</span>
        </div>
      </div>
    </div>
    
    <!-- Hero -->
    <section class="text-center mb-12">
      <h1 class="text-4xl lg:text-5xl font-bold mb-4 text-gray-800">
        Rejoignez Ludus Mentis
      </h1>
      <p class="text-lg text-gray-600">
        Préinscription pour janvier 2026 • Places limitées
      </p>
      <div class="flex gap-3 justify-center mt-4">
        <span class="badge badge-primary">10-15 ans</span>
        <span class="badge badge-secondary">8-10 places/groupe</span>
        <span class="badge badge-accent">Walhain</span>
      </div>
    </section>

    <div class="grid lg:grid-cols-2 gap-8">
      <!-- Formulaire simplifié avec AJAX -->
      <section>
        <div class="card bg-white shadow-xl">
          <div class="card-body">
            <h2 class="text-2xl font-bold mb-6 text-ludus-teal">
              Formulaire de préinscription
            </h2>
            
            <form id="contactForm" class="space-y-6">
              <!-- Infos du jeune -->
              <div class="border-2 border-teal-200 rounded-lg p-4">
                <h3 class="font-bold mb-3 text-ludus-teal">Votre enfant</h3>
                
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label for="youth_firstname" class="label">
                      <span class="label-text font-semibold">Prénom *</span>
                    </label>
                    <input type="text" id="youth_firstname" name="youth_firstname" required 
                           class="input input-bordered w-full" />
                  </div>
                  
                  <div>
                    <label for="youth_age" class="label">
                      <span class="label-text font-semibold">Âge *</span>
                    </label>
                    <select id="youth_age" name="youth_age" required 
                            class="select select-bordered w-full">
                      <option value="">Sélectionnez</option>
                      <option value="10">10 ans</option>
                      <option value="11">11 ans</option>
                      <option value="12">12 ans</option>
                      <option value="13">13 ans</option>
                      <option value="14">14 ans</option>
                      <option value="15">15 ans</option>
                    </select>
                  </div>
                </div>
              </div>
              
              <!-- Infos parent -->
              <div class="border-2 border-orange-200 rounded-lg p-4">
                <h3 class="font-bold mb-3 text-ludus-orange">Responsable légal</h3>
                
                <div class="grid md:grid-cols-2 gap-4">
                  <div>
                    <label for="parent_name" class="label">
                      <span class="label-text font-semibold">Nom complet *</span>
                    </label>
                    <input type="text" id="parent_name" name="parent_name" required 
                           class="input input-bordered w-full" />
                  </div>
                  
                  <div>
                    <label for="parent_email" class="label">
                      <span class="label-text font-semibold">Email *</span>
                    </label>
                    <input type="email" id="parent_email" name="parent_email" required 
                           class="input input-bordered w-full" />
                  </div>
                </div>
                
                <div class="mt-4">
                  <label for="parent_phone" class="label">
                    <span class="label-text font-semibold">Téléphone</span>
                  </label>
                  <input type="tel" id="parent_phone" name="parent_phone" 
                         class="input input-bordered w-full" 
                         placeholder="Optionnel" />
                </div>
              </div>
              
              <!-- Créneau souhaité -->
              <div>
                <label class="label">
                  <span class="label-text font-semibold">Créneau préféré</span>
                </label>
                <div class="space-y-2">
                  <label class="flex items-center gap-3 p-3 border rounded-lg hover:bg-base-200 cursor-pointer">
                    <input type="radio" name="schedule" value="14h" class="radio radio-primary" />
                    <span>Mercredi 14h00-16h00</span>
                  </label>
                  
                  <label class="flex items-center gap-3 p-3 border rounded-lg hover:bg-base-200 cursor-pointer">
                    <input type="radio" name="schedule" value="17h" class="radio radio-primary" />
                    <span>Mercredi 17h00-19h00</span>
                  </label>
                  
                  <label class="flex items-center gap-3 p-3 border rounded-lg hover:bg-base-200 cursor-pointer">
                    <input type="radio" name="schedule" value="flexible" checked class="radio radio-primary" />
                    <span>Les deux conviennent</span>
                  </label>
                </div>
              </div>
              
              <!-- Message -->
              <div>
                <label for="message" class="label">
                  <span class="label-text font-semibold">Message (optionnel)</span>
                </label>
                <textarea id="message" name="message" rows="3" 
                          class="textarea textarea-bordered w-full" 
                          placeholder="Questions ou informations complémentaires..."></textarea>
              </div>
              
              <!-- RGPD simplifié -->
              <div class="bg-blue-50 rounded-lg p-4">
                <label class="flex items-start gap-3">
                  <input type="checkbox" name="rgpd_consent" value="oui" required 
                         class="checkbox checkbox-primary mt-1" />
                  <span class="text-sm">
                    J'accepte que mes données soient traitées pour cette préinscription 
                    (conservation jusqu'à janvier 2026). *
                  </span>
                </label>
              </div>
              
              <!-- Submit avec état de chargement -->
              <button type="submit" id="submitBtn" class="btn btn-primary btn-lg w-full text-white">
                <span id="submitText">Envoyer la préinscription</span>
                <span id="submitLoader" class="hidden loading loading-spinner"></span>
              </button>
              
              <!-- Message d'erreur -->
              <div id="errorMessage" class="hidden alert alert-error">
                <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-6 w-6" fill="none" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
                <span id="errorText">Une erreur est survenue. Veuillez réessayer.</span>
              </div>
            </form>
          </div>
        </div>
      </section>
      
      <!-- Infos pratiques -->
      <section>
        <div class="space-y-6">
          <!-- Résumé du club -->
          <div class="card bg-gradient-to-br from-teal-50 to-orange-50">
            <div class="card-body">
              <h3 class="text-xl font-bold mb-4 text-ludus-teal">
                Ludus Mentis en bref
              </h3>
              
              <div class="space-y-3">
                <div class="flex items-start gap-3">
                  <span class="text-2xl">🎮</span>
                  <div>
                    <strong>Club de gaming social</strong>
                    <p class="text-sm text-gray-600">Sessions hebdomadaires encadrées</p>
                  </div>
                </div>
                
                <div class="flex items-start gap-3">
                  <span class="text-2xl">🤝</span>
                  <div>
                    <strong>100% coopératif</strong>
                    <p class="text-sm text-gray-600">On gagne ensemble ou on perd ensemble</p>
                  </div>
                </div>
                
                <div class="flex items-start gap-3">
                  <span class="text-2xl">⏰</span>
                  <div>
                    <strong>2h par semaine</strong>
                    <p class="text-sm text-gray-600">Mercredi après-midi</p>
                  </div>
                </div>
                
                <div class="flex items-start gap-3">
                  <span class="text-2xl">💰</span>
                  <div>
                    <strong>230€ / module</strong>
                    <p class="text-sm text-gray-600">7 semaines, tout compris</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Contact direct -->
          <div class="card bg-white shadow-xl">
            <div class="card-body text-center">
              <h3 class="text-xl font-bold mb-4">Contactez-nous directement</h3>
              
              <a href="mailto:info@ludusmentis.be" class="btn btn-outline btn-primary mb-3">
                📧 info@ludusmentis.be
              </a>
              
              <p class="text-sm text-gray-600">
                Antoine Billard, fondateur<br>
                Walhain, Brabant wallon
              </p>
              
              <div class="divider"></div>
              
              <p class="text-xs text-gray-500">
                ASBL en cours de création<br>
                Ouverture prévue : janvier 2026
              </p>
            </div>
          </div>
          
          <!-- FAQ rapide -->
          <div class="card bg-white shadow">
            <div class="card-body">
              <h3 class="font-bold mb-3">Questions rapides</h3>
              
              <div class="space-y-2 text-sm">
                <details>
                  <summary class="cursor-pointer font-medium">Faut-il du matériel ?</summary>
                  <p class="mt-2 text-gray-600">Non, tout est fourni !</p>
                </details>
                
                <details>
                  <summary class="cursor-pointer font-medium">Mon enfant est timide...</summary>
                  <p class="mt-2 text-gray-600">Parfait ! L'approche coop favorise l'inclusion.</p>
                </details>
                
                <details>
                  <summary class="cursor-pointer font-medium">Comment payer ?</summary>
                  <p class="mt-2 text-gray-600">À l'inscription ou au premier cours.</p>
                </details>
              </div>
              
              <a href="/infos-pratiques.html" class="btn btn-sm btn-outline mt-4">
                Toutes les FAQ →
              </a>
            </div>
          </div>
        </div>
      </section>
    </div>
  </main>
  
  <div id="footer"></div>
  
  <!-- Script pour envoi AJAX avec tracking GA -->
  <script>
    document.getElementById('contactForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // UI states
      const submitBtn = document.getElementById('submitBtn');
      const submitText = document.getElementById('submitText');
      const submitLoader = document.getElementById('submitLoader');
      const errorMessage = document.getElementById('errorMessage');
      const errorText = document.getElementById('errorText');
      const successMessage = document.getElementById('successMessage');
      
      // Reset messages
      errorMessage.classList.add('hidden');
      successMessage.classList.add('hidden');
      
      // Show loading state
      submitBtn.disabled = true;
      submitText.classList.add('hidden');
      submitLoader.classList.remove('hidden');
      
      // Prepare form data
      const formData = new FormData(this);
      
      try {
        // Send to Formspree
        const response = await fetch('https://formspree.io/f/mdkdwzoy', {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        });
        
        if (response.ok) {
          // Track conversion in Google Analytics
          if (typeof gtag !== 'undefined') {
            gtag('event', 'conversion', {
              'event_category': 'Préinscription',
              'event_label': 'Formulaire Contact',
              'value': 1
            });
            
            // Also track as a goal
            gtag('event', 'form_submit', {
              'form_name': 'preinscription',
              'form_destination': 'formspree',
              'value': 1
            });
          }
          
          // Show success message
          successMessage.classList.remove('hidden');
          
          // Reset form
          this.reset();
          
          // Scroll to top to see success message
          window.scrollTo({ top: 0, behavior: 'smooth' });
          
          // Hide success message after 10 seconds
          setTimeout(() => {
            successMessage.classList.add('hidden');
          }, 10000);
          
          // Log to console for debugging
          console.log('Form submitted successfully');
          
        } else {
          throw new Error('Erreur lors de l\'envoi');
        }
        
      } catch (error) {
        console.error('Form submission error:', error);
        
        // Track error in GA
        if (typeof gtag !== 'undefined') {
          gtag('event', 'exception', {
            'description': 'form_submission_error',
            'fatal': false
          });
        }
        
        // Show error message
        errorText.textContent = 'Une erreur est survenue. Veuillez réessayer ou nous contacter directement par email.';
        errorMessage.classList.remove('hidden');
        
      } finally {
        // Reset button state
        submitBtn.disabled = false;
        submitText.classList.remove('hidden');
        submitLoader.classList.add('hidden');
      }
    });
  </script>
  
  <!-- Tarteaucitron -->
  <script src="/tarteaucitron.js/tarteaucitron.js"></script>
  <script>
    tarteaucitron.init({
      "privacyUrl": "/mentions.html#cookies",
      "hashtag": "#tarteaucitron",
      "cookieName": "ludusmentis_gdpr",
      "orientation": "bottom",
      "showAlertSmall": false,
      "cookieslist": true,
      "showIcon": true,
      "iconPosition": "BottomRight",
      "adblocker": false,
      "AcceptAllCta": true,
      "highPrivacy": true,
      "handleBrowserDNTRequest": false,
      "removeCredit": false,
      "readmoreLink": "/mentions.html#cookies",
      "mandatory": false,
      "googleConsentMode": true,
      "partnersList": false
    });
    
    tarteaucitron.user.gtagUa = 'G-075RK8EJ9K';
    (tarteaucitron.job = tarteaucitron.job || []).push('gtag');
  </script>
  
  <script src="/assets/js/include.js"></script>
</body>
</html>
